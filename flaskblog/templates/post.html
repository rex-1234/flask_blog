{% extends "layout.html" %} {% block content %}

<article class="content-section post-card improved-post-card">
  <!-- Top Row: Avatar + Author + Date + Actions -->
  <div class="post-header d-flex justify-content-between align-items-start">
    <!-- Avatar + Author Info -->
    <div class="d-flex align-items-center">
      <img
        class="story-avatar me-3"
        src="{{ url_for('static', filename='profile_pics/' ~ post.author.image_file) }}"
        alt="{{ post.author.username }}'s avatar"
      />
      <div>
        <div class="post-author">{{ post.author.username }}</div>
        <div class="post-date">
          {{ post.date_posted.strftime('%b %-d, %Y') }}
        </div>
      </div>
    </div>

    <!-- Edit/Delete buttons -->
    {% if post.author == current_user %}
    <div class="post-actions">
      <a
        class="btn btn-outline-secondary btn-sm me-2"
        href="{{ url_for('posts.update_post', post_id=post.id) }}"
      >
        Edit
      </a>

      <button
        type="button"
        class="btn btn-outline-danger btn-sm"
        data-bs-toggle="modal"
        data-bs-target="#deleteModal"
      >
        Delete
      </button>
    </div>
    {% endif %}
  </div>

  <!-- Title -->
  <h2 class="post-title mt-4">{{ post.title }}</h2>

  <!-- Content -->
  <div class="post-content mt-3">{{ post.content }}</div>
</article>

<!-- Delete Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Delete Post?</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
        ></button>
      </div>

      <div class="modal-body">
        Are you sure you want to permanently delete this post?
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Cancel
        </button>

        <form
          action="{{ url_for('posts.delete_post', post_id=post.id) }}"
          method="POST"
        >
          <input class="btn btn-danger" type="submit" value="Delete" />
        </form>
      </div>
    </div>
  </div>
</div>

{% endblock %}
